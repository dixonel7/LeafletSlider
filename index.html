<!DOCTYPE html>
<html>

<head>
    <title>Leaflet Time Slider Example</title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css" type="text/css">
</head>

<body>
    <div id="map" style="width: 100%; height: 600px"></div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <!-- Include this library for mobile touch support  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>


    <script src="src/SliderControl.js"></script>

    <script>
    var sliderControl = null;

    var myMap = L.map('map').setView([52.06, 7.40], 10);

    L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(myMap);


    //Use usual LayerGroups instead of GeoJSON fetched markers
    
    var marker1 = L.marker([40.7115, -73.8716],{time: "1996/10/06", icon: myIcon, popup:'<b>October 6, 1992</b><br> Avengers gathered to counter-protest when the chair of community board 24 (Mary Cummins) had bussed in parents to do a protest about the Rainbow Curriculum. According to Maxine Wolfe, "We marched down the street in front of the Board of Ed, with the brass band in front, folled by a replica of our bomb corried by four women, surrounded by flags. The bomb and flags said "Lighten Up. Teach about Lesbians."'});
    var marker2 = L.marker([40.650002, -73.949997],{time: "1992/10/06", icon: myIcon, popup:'<b>October 6, 1992</b><br> Avengers gathered to counter-protest when the chair of community board 24 (Mary Cummins) had bussed in parents to do a protest about the Rainbow Curriculum. According to Maxine Wolfe, "We marched down the street in front of the Board of Ed, with the brass band in front, folled by a replica of our bomb corried by four women, surrounded by flags. The bomb and flags said "Lighten Up. Teach about Lesbians."'});
    var marker3 = L.marker([40.7128, - 74.0060],{time: "1992/10/29", icon: myIcon, popup:'<b>October 29, 1992</b><br>Held a press conference about the murders of Hattie Mae Cohens and Brian Mock, and "no on 9."'});
    
/*    
    .bindPopup('<b>October 29, 1992</b><br>Held a press conference about the murders of Hattie Mae Cohens and Brian Mock, and "no on 9."')
    .openPopup();
    var marker4 = L.marker([40.7303, -74.0022],{icon: myIcon}).addTo(map)
    .bindPopup('<b>October 30, 1992</b><br>As part of the Take Back the Night March, Avengers set up a shrine to Hattie Mae Cohens and Brian Mock, whose home had been set aflame in an anti-gay hate crime. When the March reached the shrine, Lesbian Avengers made a statement and eight women did a fire-eating ritual. "â€œWe take the fire of action into our hearts and we take it into our bodies. . . our fear does not consume us," they said. After the March, the Avengers kept the shrine up until November 3rd, staffing 24 hours a day.')
    .openPopup();
    var marker1 = L.marker([51.933292258, 7.582512743], {time: "2013-01-22 08:42:26+01"});
    var marker2 = L.marker([51.9, 7.6], {time: "2013-01-22 10:00:26+01"});
    var marker3 = L.marker([51.7, 7.7], {time: "2013-01-22 10:03:29+01"});
    
    var pointA = new L.LatLng(51.8, -0.09);
    var pointB = new L.LatLng(51.9, -0.2);
    var pointList = [pointA, pointB];

    var polyline = new L.Polyline(pointList, {
      time: "2013-01-22 10:24:59+01",
      color: 'red',
      weight: 3,
      opacity: 1,
      smoothFactor: 1
    });
    
*/    
    layerGroup = L.layerGroup([marker1, marker2, marker3]);
    var sliderControl = L.control.sliderControl({
                position: "topright",
                layer: layerGroup,
                alwaysShowDate: true,
                timeStrLength: 4
            });
    myMap.addControl(sliderControl);
    sliderControl.startSlider();

    function onEachFeature(layerGroup, layer) { 
        if (layerGroup.time && layerGroup.popup) { 
            layerGroup.bindPopup('test'); 
            layerGroup.on('mouseover', function(e) { 
				layerGroup.setIcon(L.icon(layerGroup.myIcon));
				var content = layerGroup.popup;
				layerGroup.bindPopup(content, {minWidth: 400, autoPanPadding: [10,80], closeButton: true});
			});
                
		                
    //Fetch some data from a GeoJSON file
/*    $.getJSON("examples/points.json", function(json) {
        var testlayer = L.geoJson(json),
            sliderControl = L.control.sliderControl({
                position: "topright",
                layer: testlayer,
                alwaysShowDate: true,
                timeStrLength: 4
            });

        //For a Range-Slider use the range property:
/*        sliderControl = L.control.sliderControl({
            position: "topright",
            layer: testlayer,
            range: true
        });


        sliderControl.on('rangechanged',function (e) {
            console.log(e.markers)
        });
*/
        //Make sure to add the slider to the map ;-)
        myMap.addControl(sliderControl);
        //And initialize the slider
        sliderControl.startSlider();
    });
    </script>
</body>

</html>
